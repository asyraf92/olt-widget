function parseConfigDate(e){let[t,i]=e.split(" "),[a,l,o]=t.split("-"),r=`${o}-${l}-${a} ${i}`;return new Date(r)}function formatDateTime(e){let t=parseConfigDate(e),i=t.toLocaleDateString(launchCONFIG.dateFormat.locale,launchCONFIG.dateFormat.dateOptions),a;if(launchCONFIG.dateFormat.customTimeFormat&&launchCONFIG.dateFormat.timeOptions.hour12){let l=t.getHours(),o=t.getMinutes(),r=o.toString().padStart(2,"0"),n;a=`${0===l?12:l>12?l-12:l}:${r} ${n=l>=1&&l<12?"PG":l>=12&&l<14?"T/HARI":l>=14&&l<19?"PTG":l>=19&&l<24?"MLM":"T/MLM"}`}else a=t.toLocaleTimeString(launchCONFIG.dateFormat.locale,launchCONFIG.dateFormat.timeOptions);return{date:i,time:a,fullDate:t}}function replacePlaceholders(e,t,i){return e.replace("{date}",t).replace("{time}",i)}function insertBeforeForm(){let e=document.getElementById("form"),t=document.getElementById("availabilityContainer"),i=document.getElementById("content");t&&e&&(e.parentNode.insertBefore(t,e),i&&(i.style.float="none"))}function setFormDisabled(e){let t=document.getElementById("order_form");if(t){if(e){t.classList.add("form-disabled");let i=t.querySelectorAll("input, select, textarea, button");i.forEach(e=>{e.disabled=!0,e.setAttribute("data-was-disabled","true")})}else{t.classList.remove("form-disabled");let a=t.querySelectorAll("input, select, textarea, button");a.forEach(e=>{"true"===e.getAttribute("data-was-disabled")&&(e.disabled=!1,e.removeAttribute("data-was-disabled"))})}}}function controlFormState(e,t=!1,i="notAvailable"){let a=document.getElementById("form"),l=document.getElementById("notAvailableMessage"),o=document.getElementById("expiredMessage");if(a){switch(setFormDisabled(!1),a.classList.remove("hidden"),l.style.display="none",o.style.display="none",e){case"hide":a.classList.add("hidden");break;case"disable":setFormDisabled(!0)}t&&launchCONFIG.formBehavior.showMessagesWhenDisabled&&("notAvailable"===i?l.style.display="block":"expired"===i&&(o.style.display="block")),launchCONFIG.debugMode&&console.log(`üîß Form state changed to: ${e}`,{showMessage:t,messageType:i})}}function applyStickyBehavior(){if(!launchCONFIG.stickyTimer.enabled)return;let e=document.getElementById("availabilityTimer"),t=document.getElementById("expiryTimer"),i=document.body;e?.classList.remove("sticky-top","sticky-bottom"),t?.classList.remove("sticky-top","sticky-bottom"),i.classList.remove("sticky-timer-top-active","sticky-timer-bottom-active");let a=new Date().getTime(),l=null;if(a<availabilityTimestamp?("availability"===launchCONFIG.stickyTimer.timerType||"both"===launchCONFIG.stickyTimer.timerType)&&(l=e):a>=availabilityTimestamp&&a<expiryTimestamp?("expiry"===launchCONFIG.stickyTimer.timerType||"both"===launchCONFIG.stickyTimer.timerType)&&(l=t):launchCONFIG.stickyTimer.disableWhenExpired||"expiry"!==launchCONFIG.stickyTimer.timerType&&"both"!==launchCONFIG.stickyTimer.timerType||(l=t),l&&!l.classList.contains("hidden")){let o="bottom"===launchCONFIG.stickyTimer.position?"sticky-bottom":"sticky-top",r="bottom"===launchCONFIG.stickyTimer.position?"sticky-timer-bottom-active":"sticky-timer-top-active";l.classList.add(o),i.classList.add(r),launchCONFIG.debugMode&&console.log(`üìå Applied sticky behavior: ${o} to timer`)}else launchCONFIG.debugMode&&a>=expiryTimestamp&&launchCONFIG.stickyTimer.disableWhenExpired&&console.log(`üìå Sticky behavior disabled - timer expired and disableWhenExpired is true`)}function thresholdToMs(e){let{hours:t=0,minutes:i=0,seconds:a=0}=e;return 36e5*t+6e4*i+1e3*a}function formatThreshold(e){let{hours:t=0,minutes:i=0,seconds:a=0}=e,l=[];return t>0&&l.push(`${t} hour${1!==t?"s":""}`),i>0&&l.push(`${i} minute${1!==i?"s":""}`),a>0&&l.push(`${a} second${1!==a?"s":""}`),l.join(", ")||"0 seconds"}function initializeTextContent(){let e=formatDateTime(launchCONFIG.availabilityDate),t=formatDateTime(launchCONFIG.expiryDate),i=replacePlaceholders(launchCONFIG.text.availabilityTitle,e.date,e.time),a=replacePlaceholders(launchCONFIG.text.expiryTitle,t.date,t.time);document.getElementById("availabilityTitle").innerHTML=i.replace(/\n/g,"<br>"),document.getElementById("expiryTitle").innerHTML=a.replace(/\n/g,"<br>"),document.getElementById("notAvailableTitle").textContent=launchCONFIG.text.notAvailableTitle,document.getElementById("notAvailableText1").textContent=launchCONFIG.text.notAvailableText1,document.getElementById("notAvailableText2").textContent=launchCONFIG.text.notAvailableText2,document.getElementById("expiredTitle").textContent=launchCONFIG.text.expiredTitle,document.getElementById("expiredText1").textContent=launchCONFIG.text.expiredText1,document.getElementById("expiredText2").textContent=launchCONFIG.text.expiredText2,launchCONFIG.debugMode&&(console.log("‚úÖ Text content initialized"),console.log("\uD83D\uDCC5 Availability title:",i),console.log("\uD83D\uDCC5 Expiry title:",a))}const availabilityTimestamp=parseConfigDate(launchCONFIG.availabilityDate).getTime(),expiryTimestamp=parseConfigDate(launchCONFIG.expiryDate).getTime(),orderForm=document.getElementById("form"),expiredMessage=document.getElementById("expiredMessage"),notAvailableMessage=document.getElementById("notAvailableMessage"),availabilityTimer=document.getElementById("availabilityTimer"),expiryTimer=document.getElementById("expiryTimer"),availDaysEl=document.getElementById("availDays"),availHoursEl=document.getElementById("availHours"),availMinutesEl=document.getElementById("availMinutes"),availSecondsEl=document.getElementById("availSeconds"),daysEl=document.getElementById("days"),hoursEl=document.getElementById("hours"),minutesEl=document.getElementById("minutes"),secondsEl=document.getElementById("seconds");let hasScrolledToForm=!1;function updateCountdowns(){let e=new Date().getTime();if(e<availabilityTimestamp){let t=availabilityTimestamp-e;availabilityTimer.classList.remove("hidden"),expiryTimer.classList.add("hidden"),controlFormState(launchCONFIG.formBehavior.beforeAvailable,"show"!==launchCONFIG.formBehavior.beforeAvailable,"notAvailable"),availDaysEl.textContent=String(Math.floor(t/864e5)).padStart(2,"0"),availHoursEl.textContent=String(Math.floor(t%864e5/36e5)).padStart(2,"0"),availMinutesEl.textContent=String(Math.floor(t%36e5/6e4)).padStart(2,"0"),availSecondsEl.textContent=String(Math.floor(t%6e4/1e3)).padStart(2,"0")}else if(e>=availabilityTimestamp&&e<expiryTimestamp){let i=expiryTimestamp-e;availabilityTimer.classList.add("hidden"),expiryTimer.classList.remove("hidden"),controlFormState("show",!1),!hasScrolledToForm&&(autoScroll(),hasScrolledToForm=!0,launchCONFIG.debugMode&&console.log("‚úÖ Auto-scrolled to form")),daysEl.textContent=String(Math.floor(i/864e5)).padStart(2,"0"),hoursEl.textContent=String(Math.floor(i%864e5/36e5)).padStart(2,"0"),minutesEl.textContent=String(Math.floor(i%36e5/6e4)).padStart(2,"0"),secondsEl.textContent=String(Math.floor(i%6e4/1e3)).padStart(2,"0"),checkLowTime(i)}else availabilityTimer.classList.add("hidden"),expiryTimer.classList.remove("hidden"),expiryTimer.classList.remove("warning","urgent"),expiryTimer.classList.add("expired"),daysEl.textContent="00",hoursEl.textContent="00",minutesEl.textContent="00",secondsEl.textContent="00",controlFormState(launchCONFIG.formBehavior.afterExpiry,"show"!==launchCONFIG.formBehavior.afterExpiry,"expired"),clearInterval(countdownInterval),launchCONFIG.debugMode&&console.log("‚è∞ Form has expired");applyStickyBehavior()}function autoScroll(){setTimeout(()=>{let e=document.getElementById("order_form");if(e){let t=0;!function i(){t++;let a=document.querySelectorAll('img[loading="lazy"], img[data-src], .lazy'),l=e.getBoundingClientRect().top+window.pageYOffset,o=Array.from(a).filter(e=>{let t=e.getBoundingClientRect().top+window.pageYOffset;return t<l}),r=o.map(e=>e.complete?Promise.resolve():new Promise(t=>{let i=setTimeout(t,1e3);e.addEventListener("load",()=>{clearTimeout(i),t()},{once:!0})}));Promise.all(r).then(()=>{let a=e.getBoundingClientRect(),l=a.top+window.pageYOffset,o=document.querySelectorAll("header, .header, .navbar"),r=0;o.forEach(e=>{let t=window.getComputedStyle(e);"fixed"===t.position&&(r=Math.max(r,e.offsetHeight))});let n=Math.max(0,l-r-30);window.scrollTo({top:n,behavior:"smooth"}),setTimeout(()=>{let a=e.getBoundingClientRect(),o=a.top+window.pageYOffset;Math.abs(o-l)>20&&t<3&&(launchCONFIG.debugMode&&console.log(`Retrying scroll, attempt ${t+1}`),i())},1500),launchCONFIG.debugMode&&console.log(`Scrolled to order form (attempt ${t})`)})}()}},500)}function checkLowTime(e){let t=thresholdToMs(launchCONFIG.warningThresholds.lowTime),i=thresholdToMs(launchCONFIG.warningThresholds.flashTime);if(e<=t&&e>0&&(expiryTimer.classList.remove("urgent"),expiryTimer.classList.add("warning"),launchCONFIG.debugMode)){let a=formatTimeRemaining(e);console.log(`‚ö†Ô∏è Low time warning triggered! Time left: ${a}`)}if(e<=i&&e>0&&(expiryTimer.classList.remove("warning"),expiryTimer.classList.add("urgent"),launchCONFIG.debugMode)){let l=formatTimeRemaining(e);console.log(`üö® Flash warning triggered! Time left: ${l}`)}e>t&&(expiryTimer.classList.remove("warning","urgent"),expiryTimer.style.background="",expiryTimer.style.boxShadow="")}function formatTimeRemaining(e){let t=Math.floor(e/36e5),i=Math.floor(e%36e5/6e4),a=Math.floor(e%6e4/1e3),l=[];return t>0&&l.push(`${t}h`),i>0&&l.push(`${i}m`),a>0&&l.push(`${a}s`),l.join(" ")||"0s"}insertBeforeForm(),initializeTextContent(),updateCountdowns();const countdownInterval=setInterval(updateCountdowns,1e3);if(applyStickyBehavior(),launchCONFIG.debugMode){let e=formatDateTime(launchCONFIG.availabilityDate),t=formatDateTime(launchCONFIG.expiryDate);console.log("\uD83D\uDE80 Order Form Configuration:"),console.log("\uD83D\uDCC5 Availability Date:",e.date),console.log("‚è∞ Availability Time:",e.time),console.log("\uD83D\uDCC5 Expiry Date:",t.date),console.log("‚è∞ Expiry Time:",t.time),console.log("\uD83D\uDD50 Current time:",new Date().toLocaleString()),console.log("‚ö†Ô∏è Low time warning:",formatThreshold(launchCONFIG.warningThresholds.lowTime)),console.log("\uD83D\uDEA8 Flash warning:",formatThreshold(launchCONFIG.warningThresholds.flashTime)),console.log("\uD83C\uDF9BÔ∏è Form behavior settings:",launchCONFIG.formBehavior),console.log("\uD83D\uDCCC Sticky timer settings:",launchCONFIG.stickyTimer)}